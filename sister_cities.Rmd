---
title: "Chinese Sister-Cities"
author: "Naimul Chowdhury"
date: "09/27/2020"
output: html_notebook
---

##1. Setup
### options
Set up global options
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(tidy=TRUE)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=70))
knitr::opts_chunk$set(fig.height=4, fig.width=6)
```

### libraries
Load in needed libraries 
```{r, include=FALSE}
library(tidyverse)
library(RColorBrewer)
library(plotly)
```

## 2. File management
### Create variables for directories
```{r file_management, include=FALSE}
project.dir <- "/home/naeem/development/internships/VSFS/CN_AUS_Sisters" #naeem
output.dir <- file.path(project.dir, "output")
data.dir <- file.path(project.dir, "data")
setwd(project.dir)
getwd()

cities <- read.csv(file.path(data.dir, "all_cities.csv"))
sisters <- read.csv(file.path(data.dir, "aus_cn.csv"))
```

## 3. Playground

### Line Mapping
```{r}
### Data Read-in
air <- read_csv('https://raw.githubusercontent.com/plotly/datasets/master/2011_february_us_airport_traffic.csv')
flights <- read_csv('https://raw.githubusercontent.com/plotly/datasets/master/2011_february_aa_flight_paths.csv')
flights$id <- seq_len(nrow(flights))

geo <- list(
  scope = 'world', #TODO 1 Find Scope Parameters
  projection = list(type = 'azimuthal equal area'), 
  showland = TRUE, 
  landcolor = toRGB("gray95"), #TODO 2 Set Color
  countrycolor = toRGB("gray80")
)

fig <- plot_geo(locationmode = 'country names', color = I("red"))


# TODO 3 hoverinfo = city name
# TODO 4 Set Color to be different from lines
# Plots the dots
fig <- fig %>% add_markers( 
  data = air, x = ~long, y = ~lat, text = ~airport,
  size = ~cnt, hoverinfo = "text", alpha = 1
)


#TODO 5 x = AUS_lon, x_end = CN_lon, y=AUS_lat, yend = CN_lat
#TODO 6 hoverinfo = "comments"
fig <- fig %>% add_segments(
    data = group_by(flights, id),
    x = ~start_lon, xend = ~end_lon,
    y = ~start_lat, yend = ~end_lat,
    alpha = 0.3, size = I(1), hoverinfo = "none"
  )

fig <- fig %>% layout(
    title = 'VSFS Test Map for Sister Cities',
    geo = list(
      resolution = 100,
      showland = TRUE,
      showlakes = TRUE,
      landcolor = toRGB("grey80"),
      countrycolor = toRGB("grey80"),
      lakecolor = toRGB("white"),
      projection = list(type = "equirectangular"),
      coastlinewidth = 2,
      lataxis = list(
        range = c(-100, 100),
        showgrid = TRUE,
        tickmode = "linear",
        dtick = 10
        ),
      lonaxis = list(
        range = c(0, 100),
        showgrid = TRUE,
        tickmode = "linear",
        dtick = 20
      )
    )
    , showlegend = FALSE, height=500
)

fig

```

